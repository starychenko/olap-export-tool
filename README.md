# OLAP Export Tool

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ –µ–∫—Å–ø–æ—Ä—Ç—É –¥–∞–Ω–∏—Ö –∑ OLAP –∫—É–±—ñ–≤ (Microsoft Analysis Services) —É —Ñ–∞–π–ª–∏ Excel —Ç–∞ CSV –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é CLI, –ø—Ä–æ—Ñ—ñ–ª—ñ–≤, –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫–∞ —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö –ø–µ—Ä—ñ–æ–¥—ñ–≤.

## üéØ –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- **CLI –∞—Ä–≥—É–º–µ–Ω—Ç–∏** - –≥–Ω—É—á–∫–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏** - 7 –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ä–æ–∑—É–º–Ω–∏—Ö –ø–µ—Ä—ñ–æ–¥—ñ–≤ (–æ—Å—Ç–∞–Ω–Ω—ñ N —Ç–∏–∂–Ω—ñ–≤, –ø–æ—Ç–æ—á–Ω–∏–π –º—ñ—Å—è—Ü—å, –∫–≤–∞—Ä—Ç–∞–ª —ñ —Ç.–¥.)
- **–ü—Ä–æ—Ñ—ñ–ª—ñ** - –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–±–æ—Ä—ñ–≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤
- **–ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –µ–∫—Å–ø–æ—Ä—Ç—ñ–≤ –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º
- **–°—Ç–∏—Å–Ω–µ–Ω–Ω—è** - ZIP –∞—Ä—Ö—ñ–≤–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- **–î–≤–∞ –º–µ—Ç–æ–¥–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** - Windows (SSPI) —Ç–∞ –õ–æ–≥—ñ–Ω/–ü–∞—Ä–æ–ª—å
- **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö** - –±–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
- **–ü–æ—Ç–æ–∫–æ–≤–∏–π –µ–∫—Å–ø–æ—Ä—Ç** - –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ —Ä–æ–±–æ—Ç–∞ –∑ –≤–µ–ª–∏–∫–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–∏—Ö

## üìã –í–∏–º–æ–≥–∏

### Python
- **–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ:** Python 3.13
- **–ü—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è:** Python 3.8 - 3.13
- **–û–±–º–µ–∂–µ–Ω–æ:** Python 3.14+ (–±–µ–∑ OLAP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è)

> **‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ:** Python 3.14 –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î pythonnet, —Ç–æ–º—É –µ–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö –ø—Ä–∞—Ü—é—î –ª–∏—à–µ –Ω–∞ Python 3.8-3.13

### –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
```bash
pip install -r requirements.txt
```

–û—Å–Ω–æ–≤–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏:
- `pythonnet` - .NET —ñ–Ω—Ç–µ—Ä–æ–ø –¥–ª—è ADOMD.NET (Python 3.8-3.13)
- `pandas`, `xlsxwriter`, `numpy` - –æ–±—Ä–æ–±–∫–∞ —Ç–∞ –µ–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö
- `PyYAML` - –ø—Ä–æ—Ñ—ñ–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- `schedule` - –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –∑–∞–¥–∞—á
- `cryptography` - —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
- `python-dotenv`, `colorama` - –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Ç–∞ UI

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–°–∫–æ–ø—ñ—é–π—Ç–µ `.env.example` –≤ `.env` —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

```bash
cp .env.example .env
```

–û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤ `.env`:
```bash
# OLAP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
OLAP_SERVER=10.40.0.48
OLAP_DATABASE=Sells

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è: SSPI (Windows) –∞–±–æ LOGIN (–ª–æ–≥—ñ–Ω/–ø–∞—Ä–æ–ª—å)
OLAP_AUTH_METHOD=LOGIN
OLAP_DOMAIN=EPICENTRK

# –§—ñ–ª—å—Ç—Ä —Ç–∞ –ø–µ—Ä—ñ–æ–¥–∏
FILTER_FG1_NAME=–°–ø–æ–∂–∏–≤—á–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞
YEAR_WEEK_START=2025-01
YEAR_WEEK_END=2025-52

# –§–æ—Ä–º–∞—Ç –µ–∫—Å–ø–æ—Ä—Ç—É
EXPORT_FORMAT=XLSX  # XLSX, CSV –∞–±–æ BOTH
QUERY_TIMEOUT=30    # –¢–∞–π–º–∞—É—Ç –º—ñ–∂ –∑–∞–ø–∏—Ç–∞–º–∏
```

### 2. –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫

```bash
# –ë–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑ .env
python olap.py

# –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –∑ LOGIN –º–µ—Ç–æ–¥–æ–º –≤–≤–µ–¥—ñ—Ç—å –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ
# –í–æ–Ω–∏ –±—É–¥—É—Ç—å –±–µ–∑–ø–µ—á–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ —Ç–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ
```

## üí° –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤—ñ –∫–æ–º–∞–Ω–¥–∏

```bash
# –î–æ–ø–æ–º–æ–≥–∞
python olap.py --help

# –ï–∫—Å–ø–æ—Ä—Ç –∑ .env –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ (–∑–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å)
python olap.py

# –û—á–∏—Å—Ç–∏—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ
python olap.py clear_credentials
```

### CLI –ê—Ä–≥—É–º–µ–Ω—Ç–∏

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏

```bash
# –û—Å—Ç–∞–Ω–Ω—ñ 4 —Ç–∏–∂–Ω—ñ
python olap.py --last-weeks 4 --format xlsx --compress zip

# –ü–æ—Ç–æ—á–Ω–∏–π –º—ñ—Å—è—Ü—å
python olap.py --current-month --format csv

# –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –º—ñ—Å—è—Ü—å
python olap.py --last-month --format both

# –ü–æ—Ç–æ—á–Ω–∏–π –∫–≤–∞—Ä—Ç–∞–ª (Q1-Q4)
python olap.py --current-quarter --compress zip

# –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫–≤–∞—Ä—Ç–∞–ª
python olap.py --last-quarter --format xlsx

# –ó –ø–æ—á–∞—Ç–∫—É —Ä–æ–∫—É –¥–æ —Å—å–æ–≥–æ–¥–Ω—ñ
python olap.py --year-to-date --compress zip

# –ö–æ–≤–∑–∞—é—á–µ –≤—ñ–∫–Ω–æ 12 —Ç–∏–∂–Ω—ñ–≤
python olap.py --rolling-weeks 12 --format xlsx
```

#### –†—É—á–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏

```bash
# –î—ñ–∞–ø–∞–∑–æ–Ω –ø–µ—Ä—ñ–æ–¥—ñ–≤
python olap.py --period 2025-01:2025-52 --format xlsx

# –ê–±–æ –æ–∫—Ä–µ–º–æ –ø–æ—á–∞—Ç–æ–∫ —Ç–∞ –∫—ñ–Ω–µ—Ü—å
python olap.py --start 2025-01 --end 2025-12
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç—É

```bash
# –§–æ—Ä–º–∞—Ç: xlsx, csv –∞–±–æ both
python olap.py --last-weeks 4 --format both

# –ö–∞—Å—Ç–æ–º–Ω–∏–π —Ñ—ñ–ª—å—Ç—Ä
python olap.py --current-month --filter "–ü–æ–±—É—Ç–æ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞"

# –¢–∞–π–º–∞—É—Ç –º—ñ–∂ –∑–∞–ø–∏—Ç–∞–º–∏
python olap.py --last-quarter --timeout 60

# ZIP —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è (–æ—Ä–∏–≥—ñ–Ω–∞–ª–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è)
python olap.py --year-to-date --compress zip
```

### –ü—Ä–æ—Ñ—ñ–ª—ñ

–ü—Ä–æ—Ñ—ñ–ª—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –Ω–∞–±–æ—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤.

```bash
# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –ø—Ä–æ—Ñ—ñ–ª—ñ–≤
python olap.py --list-profiles

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é
python olap.py --profile weekly_sales

# –ü–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –ø—Ä–æ—Ñ—ñ–ª—é
python olap.py --profile weekly_sales --format csv --compress none
```

#### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é

–°—Ç–≤–æ—Ä—ñ—Ç—å YAML —Ñ–∞–π–ª —É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `profiles/`:

```yaml
# profiles/my_report.yaml
name: my_report
description: –ú—ñ–π –≤–ª–∞—Å–Ω–∏–π –∑–≤—ñ—Ç

period:
  type: auto              # auto –∞–±–æ manual
  auto_type: last-weeks   # –¢–∏–ø –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –ø–µ—Ä—ñ–æ–¥—É
  auto_value: 4           # –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–∏–∂–Ω—ñ–≤

export:
  format: xlsx            # xlsx, csv –∞–±–æ both
  compress: zip           # zip –∞–±–æ none
  streaming: true         # –ü–æ—Ç–æ–∫–æ–≤–∏–π –µ–∫—Å–ø–æ—Ä—Ç –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö

filter:
  fg1_name: –°–ø–æ–∂–∏–≤—á–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞

connection:
  timeout: 30             # –¢–∞–π–º–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
```

–í–±—É–¥–æ–≤–∞–Ω—ñ –ø—Ä–æ—Ñ—ñ–ª—ñ:
- `weekly_sales` - –©–æ—Ç–∏–∂–Ω–µ–≤–∏–π –∑–≤—ñ—Ç (–æ—Å—Ç–∞–Ω–Ω—ñ–π —Ç–∏–∂–¥–µ–Ω—å)
- `monthly_report` - –ú—ñ—Å—è—á–Ω–∏–π –∑–≤—ñ—Ç (–ø–æ—Ç–æ—á–Ω–∏–π –º—ñ—Å—è—Ü—å)
- `quarterly_analysis` - –ö–≤–∞—Ä—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ (–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫–≤–∞—Ä—Ç–∞–ª)

### –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –µ–∫—Å–ø–æ—Ä—Ç—ñ–≤ –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º.

```bash
# –ó–∞–ø—É—Å–∫ –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è)
python olap.py --profile weekly_sales --schedule "every monday at 09:00"

# Daemon —Ä–µ–∂–∏–º (–ø–æ—Å—Ç—ñ–π–Ω–∞ —Ä–æ–±–æ—Ç–∞ –≤ —Ñ–æ–Ω—ñ)
python olap.py --profile weekly_sales --daemon
```

#### –§–æ—Ä–º–∞—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥—É

–ü—Ä–æ—Å—Ç–∏–π —Ñ–æ—Ä–º–∞—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π):
```
"every monday at 09:00"
"every day at 18:00"
"every 1 week"
"every 3 days at 14:30"
```

#### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É –≤ –ø—Ä–æ—Ñ—ñ–ª—ñ

```yaml
schedule:
  enabled: true
  simple: "every monday at 09:00"
  description: –ö–æ–∂–µ–Ω –ø–æ–Ω–µ–¥—ñ–ª–æ–∫ –æ 9:00
```

## üìä –§–æ—Ä–º–∞—Ç–∏ –µ–∫—Å–ø–æ—Ä—Ç—É

### XLSX (Excel)
- –§–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
- Freeze panes
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –µ–∫—Å–ø–æ—Ä—Ç—É –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö

### CSV
- –ù–∞–ª–∞—à—Ç–æ–≤—É–≤–∞–Ω–∏–π —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫ (`;`, `,`, tab)
- –ö–æ–¥—É–≤–∞–Ω–Ω—è (utf-8-sig, utf-8)
- –†–µ–∂–∏–º–∏ —Ü–∏—Ç—É–≤–∞–Ω–Ω—è (minimal, all, nonnumeric)

### ZIP
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –ø—ñ—Å–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—É —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è

## üîê –ë–µ–∑–ø–µ–∫–∞

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è

**Windows (SSPI):**
```bash
OLAP_AUTH_METHOD=SSPI
```
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Windows –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

**–õ–æ–≥—ñ–Ω/–ü–∞—Ä–æ–ª—å:**
```bash
OLAP_AUTH_METHOD=LOGIN
OLAP_DOMAIN=EPICENTRK
OLAP_CREDENTIALS_ENCRYPTED=true
```

–ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –≤–≤–µ–¥—ñ—Ç—å –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ. –í–æ–Ω–∏ –±—É–¥—É—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ —É —Ñ–∞–π–ª `.credentials`.

### –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è

- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Fernet —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (cryptography)
- –ü—Ä–∏–≤'—è–∑–∫–∞ –¥–æ –º–∞—à–∏–Ω–∏ (–∫–æ–º–ø'—é—Ç–µ—Ä, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –¥–∏—Å–∫)
- –û–ø—Ü—ñ–π–Ω–∏–π –º–∞–π—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É

```bash
OLAP_USE_MASTER_PASSWORD=true
OLAP_MASTER_PASSWORD=your_master_password
```

### –û—á–∏—â–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

```bash
python olap.py clear_credentials
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

```
result/
‚îú‚îÄ‚îÄ 2025/
‚îÇ   ‚îú‚îÄ‚îÄ 2025-01.xlsx
‚îÇ   ‚îú‚îÄ‚îÄ 2025-02.xlsx
‚îÇ   ‚îú‚îÄ‚îÄ 2025-01_to_2025-12_export_20251224_100530.zip
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ 2024/
    ‚îî‚îÄ‚îÄ ...
```

–§–æ—Ä–º–∞—Ç –Ω–∞–∑–≤ —Ñ–∞–π–ª—ñ–≤:
- –û–¥–∏–Ω —Ç–∏–∂–¥–µ–Ω—å: `YYYY-WW.xlsx`
- –ö—ñ–ª—å–∫–∞ —Ç–∏–∂–Ω—ñ–≤: `YYYY-WW_to_YYYY-WW_export_TIMESTAMP.zip`

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

1. **CLI –∞—Ä–≥—É–º–µ–Ω—Ç–∏** (–Ω–∞–π–≤–∏—â–∏–π)
2. **–ü—Ä–æ—Ñ—ñ–ª—å** (—è–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ `--profile`)
3. **.env —Ñ–∞–π–ª** (–±–∞–∑–æ–≤–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è)
4. **Defaults** (–≤–±—É–¥–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è)

### –û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ .env

```bash
# === OLAP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è ===
OLAP_SERVER=10.40.0.48              # IP –∞–±–æ hostname
OLAP_DATABASE=Sells                  # –ù–∞–∑–≤–∞ –±–∞–∑–∏
OLAP_PORT=2383                       # –ü–æ—Ä—Ç (–æ–ø—Ü—ñ–π–Ω–æ)
OLAP_AUTH_METHOD=LOGIN               # SSPI –∞–±–æ LOGIN

# === –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è ===
OLAP_DOMAIN=EPICENTRK                # –î–æ–º–µ–Ω
OLAP_CREDENTIALS_ENCRYPTED=true      # –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
OLAP_USE_MASTER_PASSWORD=false       # –ú–∞–π—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—å

# === –ó–∞–ø–∏—Ç–∏ ===
FILTER_FG1_NAME=–°–ø–æ–∂–∏–≤—á–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞ # –§—ñ–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
YEAR_WEEK_START=2025-01              # –ü–æ—á–∞—Ç–æ–∫ –ø–µ—Ä—ñ–æ–¥—É
YEAR_WEEK_END=2025-52                # –ö—ñ–Ω–µ—Ü—å –ø–µ—Ä—ñ–æ–¥—É
QUERY_TIMEOUT=30                     # –¢–∞–π–º–∞—É—Ç –º—ñ–∂ –∑–∞–ø–∏—Ç–∞–º–∏

# === –ï–∫—Å–ø–æ—Ä—Ç ===
EXPORT_FORMAT=XLSX                   # XLSX, CSV, BOTH
XLSX_STREAMING=false                 # –ü–æ—Ç–æ–∫–æ–≤–∏–π –µ–∫—Å–ø–æ—Ä—Ç
XLSX_MIN_FORMAT=false                # –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
FORCE_CSV_ONLY=false                 # –§–æ—Ä—Å—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ CSV

# === CSV ===
CSV_DELIMITER=;                      # –†–æ–∑–¥—ñ–ª—å–Ω–∏–∫
CSV_ENCODING=utf-8-sig               # –ö–æ–¥—É–≤–∞–Ω–Ω—è
CSV_QUOTING=minimal                  # minimal, all, nonnumeric

# === Excel —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è ===
EXCEL_HEADER_COLOR=00365E            # –ö–æ–ª—ñ—Ä —Ñ–æ–Ω—É –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤
EXCEL_HEADER_FONT_COLOR=FFFFFF       # –ö–æ–ª—ñ—Ä —Ç–µ–∫—Å—Ç—É
EXCEL_HEADER_FONT_SIZE=11            # –†–æ–∑–º—ñ—Ä —à—Ä–∏—Ñ—Ç—É

# === –Ü–Ω—à–µ ===
DEBUG=false                          # –†–µ–∂–∏–º –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è
OLAP_ASCII_LOGS=false                # ASCII —Ñ–æ–ª–±–µ–∫ –¥–ª—è –ª–æ–≥—ñ–≤
```

## üêõ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### Python 3.14
–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ Python 3.14, –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –±–∞–∑–æ–≤—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
```bash
pip install python-dotenv colorama PyYAML schedule pandas xlsxwriter numpy cryptography
```

CLI –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, –∞–ª–µ –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É –¥–∞–Ω–∏—Ö –ø–æ—Ç—Ä—ñ–±–µ–Ω Python 3.13.

–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ: [PYTHON_COMPATIBILITY.md](PYTHON_COMPATIBILITY.md)

### –ü–æ–º–∏–ª–∫–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

**"–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ OLAP"**
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `OLAP_SERVER` —Ç–∞ `OLAP_DATABASE`
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ (`ping 10.40.0.48`)
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª —Ç–∞ –º–µ—Ä–µ–∂–µ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

**"–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó"**
- –û—á–∏—Å—Ç—ñ—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ: `python olap.py clear_credentials`
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `OLAP_DOMAIN` —Ç–∞ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ
- –î–ª—è SSPI –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ Windows –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### –ü–æ–º–∏–ª–∫–∏ –º–æ–¥—É–ª—ñ–≤

**"ModuleNotFoundError: No module named 'pythonnet'"**
```bash
pip install pythonnet>=3.0.0
```
–ü—Ä–∏–º—ñ—Ç–∫–∞: –ü–æ—Ç—Ä—ñ–±–µ–Ω Python 3.8-3.13

**"ModuleNotFoundError: No module named 'yaml'"**
```bash
pip install PyYAML>=6.0.0
```

## üìö –î–æ–¥–∞—Ç–∫–æ–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- **[UPGRADE_GUIDE.md](UPGRADE_GUIDE.md)** - –î–µ—Ç–∞–ª—å–Ω–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫ –∑ —É—Å—ñ–º–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏
- **[PYTHON_COMPATIBILITY.md](PYTHON_COMPATIBILITY.md)** - –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ –≤–µ—Ä—Å—ñ—è–º–∏ Python
- **[.env.example](.env.example)** - –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑ –æ–ø–∏—Å–æ–º –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

## üéì –ü—Ä–∏–∫–ª–∞–¥–∏ —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤

### –©–æ—Ç–∏–∂–Ω–µ–≤–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–≤—ñ—Ç

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–æ—Ñ—ñ–ª—å `profiles/weekly_auto.yaml`:
```yaml
name: weekly_auto
description: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —â–æ—Ç–∏–∂–Ω–µ–≤–∏–π –∑–≤—ñ—Ç

period:
  type: auto
  auto_type: last-weeks
  auto_value: 1

export:
  format: xlsx
  compress: zip

schedule:
  enabled: true
  simple: "every monday at 06:00"
```

2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å daemon:
```bash
python olap.py --profile weekly_auto --daemon
```

### –ú—ñ—Å—è—á–Ω–∏–π –∑–≤—ñ—Ç

```bash
# –í—Ä—É—á–Ω—É
python olap.py --current-month --format both --compress zip

# –ê–±–æ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ñ—ñ–ª—å
python olap.py --profile monthly_report
```

### –ê–Ω–∞–ª—ñ–∑ –∑–∞ —Ä—ñ–∫

```bash
python olap.py --year-to-date --format xlsx --compress zip
```

### –ö–≤–∞—Ä—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç –∑ –∫–∞—Å—Ç–æ–º–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```bash
python olap.py --last-quarter \
  --filter "–ü–æ–±—É—Ç–æ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞" \
  --format xlsx \
  --timeout 60 \
  --compress zip
```

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
olap-export-tool/
‚îú‚îÄ‚îÄ olap.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É
‚îú‚îÄ‚îÄ .env                       # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .env.example               # –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
‚îú‚îÄ‚îÄ requirements.txt           # Python –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ README.md                  # –¶—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ UPGRADE_GUIDE.md           # –î–µ—Ç–∞–ª—å–Ω–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫
‚îú‚îÄ‚îÄ PYTHON_COMPATIBILITY.md    # –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å Python
‚îÇ
‚îú‚îÄ‚îÄ olap_tool/                 # –û—Å–Ω–æ–≤–Ω–∏–π –ø–∞–∫–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ cli.py                 # CLI –∞—Ä–≥—É–º–µ–Ω—Ç–∏ (–ù–û–í–ò–ô)
‚îÇ   ‚îú‚îÄ‚îÄ periods.py             # –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏ (–ù–û–í–ò–ô)
‚îÇ   ‚îú‚îÄ‚îÄ compression.py         # ZIP —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è (–ù–û–í–ò–ô)
‚îÇ   ‚îú‚îÄ‚îÄ profiles.py            # –ü—Ä–æ—Ñ—ñ–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó (–ù–û–í–ò–ô)
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.py           # –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –∑–∞–¥–∞—á (–ù–û–í–ò–ô)
‚îÇ   ‚îú‚îÄ‚îÄ runner.py              # –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ queries.py             # DAX –∑–∞–ø–∏—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ exporter.py            # –ï–∫—Å–ø–æ—Ä—Ç —É —Ñ–∞–π–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ connection.py          # OLAP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ auth.py                # –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ security.py            # –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ progress.py            # –ü—Ä–æ–≥—Ä–µ—Å –±–∞—Ä
‚îÇ   ‚îî‚îÄ‚îÄ utils.py               # –£—Ç–∏–ª—ñ—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ profiles/                  # –ü—Ä–æ—Ñ—ñ–ª—ñ (YAML)
‚îÇ   ‚îú‚îÄ‚îÄ weekly_sales.yaml
‚îÇ   ‚îú‚îÄ‚îÄ monthly_report.yaml
‚îÇ   ‚îî‚îÄ‚îÄ quarterly_analysis.yaml
‚îÇ
‚îú‚îÄ‚îÄ result/                    # –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –µ–∫—Å–ø–æ—Ä—Ç—É
‚îÇ   ‚îî‚îÄ‚îÄ YYYY/
‚îÇ       ‚îú‚îÄ‚îÄ YYYY-WW.xlsx
‚îÇ       ‚îî‚îÄ‚îÄ *.zip
‚îÇ
‚îú‚îÄ‚îÄ logs/                      # –õ–æ–≥–∏ –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ scheduler_YYYY-MM-DD.log
‚îÇ
‚îî‚îÄ‚îÄ lib/                       # ADOMD.NET –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
    ‚îî‚îÄ‚îÄ Microsoft.AnalysisServices.AdomdClient.dll
```

## ü§ù –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–ü—Ä–∏ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º:

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é:
   - `README.md` (—Ü–µ–π —Ñ–∞–π–ª)
   - `UPGRADE_GUIDE.md`
   - `PYTHON_COMPATIBILITY.md`

2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `.env` –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é

3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∑ `--debug` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –ª–æ–≥—ñ–≤:
   ```bash
   python olap.py --debug --last-weeks 1
   ```

4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–µ—Ä—Å—ñ—é Python:
   ```bash
   python --version  # –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è 3.13
   ```

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –µ–∫—Å–ø–æ—Ä—Ç—É –¥–∞–Ω–∏—Ö –∑ OLAP –∫—É–±—ñ–≤.

## üéØ –í–µ—Ä—Å—ñ—è

**v2.0** - –î–æ–¥–∞–Ω–æ CLI, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏, –ø—Ä–æ—Ñ—ñ–ª—ñ, –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ —Ç–∞ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤.

---

**–ê–≤—Ç–æ—Ä:** OLAP Export Tool Team
**–î–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 24 –≥—Ä—É–¥–Ω—è 2025
